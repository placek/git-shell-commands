#!/usr/bin/env sh

reposDir="/srv/run"

if [ -z "$1" ]; then
  >&2 echo "exiting, no repo name input to delete"
  >&2 echo "usage: 'remove <repo>'"
  exit 1
fi

case "$1" in
*.git)
  deleteRepoDir=$reposDir/$1
  ;;
*)
  deleteRepoDir=$reposDir/$1.git
  ;;
esac

if [ ! -d "$deleteRepoDir" ]; then
  >&2 echo "exiting, repo '$deleteRepoDir' does not exist"
  exit 1
fi

echo "are you sure to delete the repo '$deleteRepoDir' (y/n)?"
read -r choice

case "$choice" in
  y|Y) echo "'yes' selected, deleting '$deleteRepoDir'" ;;
  *)   echo "exiting" && exit 0 ;;
esac

rm -rf "$deleteRepoDir"

echo "repo '$deleteRepoDir' has been deleted"
